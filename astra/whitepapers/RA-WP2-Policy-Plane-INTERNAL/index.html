
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://astra.unbolt.ai/astra/whitepapers/RA-WP2-Policy-Plane-INTERNAL/">
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>Agent Security and Trust Reference Architecture (ASTRA) — Policy Plane - ASTRA Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#agent-security-and-trust-reference-architecture-astra-policy-plane" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="ASTRA Documentation" class="md-header__button md-logo" aria-label="ASTRA Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ASTRA Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Agent Security and Trust Reference Architecture (ASTRA) — Policy Plane
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/unboltai/astra" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Introduction

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../reference/01-purpose-scope-positioning/" class="md-tabs__link">
          
  
  
  Reference Architecture

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../guide/15-implementation-patterns/" class="md-tabs__link">
          
  
  
  Implementation Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../faq/" class="md-tabs__link">
        
  
  
    
  
  FAQs

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="ASTRA Documentation" class="md-nav__button md-logo" aria-label="ASTRA Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    ASTRA Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/unboltai/astra" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Reference Architecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Reference Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/01-purpose-scope-positioning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1. Purpose, scope, positioning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/02-current-state/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2. Current state assessment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/05-architecture-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5. Architecture overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/08-identity-trust-attestation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    8. Identity, trust, attestation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/09-policy-governance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    9. Policy and governance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/10-lineage-causal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    10. Data lineage & causal auditing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/11-threat-controls/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    11. Threat model & controls
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/13-deployment-ops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    13. Deployment & ops
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/14-interop-standards/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    14. Interop & standards
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Implementation Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Implementation Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/15-implementation-patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    15. Implementation patterns
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/15d-anti-patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    15d. Anti-patterns
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/16-validation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    16. Validation & benchmarks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/17-controls-catalog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    17. Controls catalog
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/18a-pilot-to-production/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    18a. Pilot-to-production
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/18b-foundation-to-scale/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    18b. Foundation-to-Scale path
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQs
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="agent-security-and-trust-reference-architecture-astra-policy-plane">Agent Security and Trust Reference Architecture (ASTRA) — Policy Plane</h1>
<p>Version 0.1 (INTERNAL Draft) | Target publish: September 4, 2025</p>
<hr />
<h2 id="executive-summary">Executive Summary</h2>
<p>The ASTRA Policy Plane is the intelligence center of the Agent Security Control Plane. It converts organizational governance into real‑time decisions for every agent‑to‑tool interaction, using policy‑as‑code with explainability, low latency, and enterprise integration. This paper specifies the Policy Decision Point (PDP), Policy Information Point (PIP), canonical policy input schema, decision caching, and operational guardrails.</p>
<hr />
<h2 id="scope-and-nongoals">Scope and Non‑Goals</h2>
<ul>
<li>In Scope: PDP design, PIP context assembly, canonical input schema and validators, decision caching, explain‑deny, policy lifecycle (versioning, tests, rollouts), interfaces (CLI/REST/SDK), performance targets, observability, and security.</li>
<li>Non‑Goals: Gateway mechanics (RA‑WP3), audit pipeline internals (RA‑WP4), identity/secrets (RA‑WP5), A2A governance (RA‑WP6).</li>
</ul>
<hr />
<h2 id="design-principles">Design Principles</h2>
<ul>
<li>
<p>Policy‑as‑Code: Rego policies with version control, golden tests, and code review flows <a href="#7">[7]</a>
  The Policy Plane treats governance as software. Policies live alongside code, benefit from reviews and tests, and can be rolled out or rolled back like any other artifact. This creates a predictable, auditable change process and eliminates configuration drift.</p>
</li>
<li>
<p>Low‑Latency First: Sub‑50ms uncached, sub‑5ms cached decisions
  Decision latency must never block agent workflows. We achieve this with an OPA server (long‑lived evaluator), Redis caching for hot paths, and careful schema design to minimize evaluation complexity while preserving expressiveness.</p>
</li>
<li>
<p>Deterministic Inputs: Canonical, validated schema; no nested input.input
  Policies are only as reliable as their inputs. A single, versioned schema—with strict validation and field-level semantics—ensures evaluations are deterministic and safe to optimize. Unknown or malformed fields lead to default‑deny and clear errors.</p>
</li>
<li>
<p>Context‑Rich: Agent, tool, environment, history, and intent signals
  Real‑world decisions require more than who and what. We incorporate when, where, and why: environmental conditions, prior violations, and declared vs. inferred intent. This enables nuanced allow/deny/escalate outcomes that match enterprise risk posture.</p>
</li>
<li>
<p>Explainability: Always return decision + reason + remediation hint
  Developers and auditors must understand why a call was allowed or denied. The PDP returns concise reasons (e.g., missing scope) and hints (e.g., required capability) to speed remediation and build trust in the system.</p>
</li>
<li>
<p>Safety: Deny by default; escalate with human approval under uncertainty
  When confidence is low—ambiguous intent, unusual access patterns, or missing context—the system chooses safety. Escalation paths are built‑in, preserving velocity without compromising control.</p>
</li>
</ul>
<hr />
<h2 id="architecture-overview">Architecture Overview</h2>
<pre><code class="language-mermaid">flowchart LR
  PIP[Policy Information Point&lt;br/&gt;Context Assembly] --&gt; PDP[Policy Decision Point&lt;br/&gt;Policy Evaluator (e.g., OPA) + Cache]
  PDP --&gt;|decision + reason| SAG[Secure Agent Gateway]
  POLICY_REPO[(Policy Repo&lt;br/&gt;Policy Packages (e.g., bundles)]] --&gt; PDP
  REDIS[(Redis Cache)] &lt;--&gt; PDP
  OBS[Observability Pipeline&lt;br/&gt;(e.g., OTel) Traces/Logs] &lt;--&gt; PDP
</code></pre>
<p>The PDP is a long‑running policy evaluator (e.g., OPA) with decision caching layered in front to absorb repeated evaluations. The PIP assembles context from the gateway and supporting sources, normalizes it to the canonical schema, and attaches correlation identifiers for observability. Policies are distributed as signed packages (e.g., OPA bundles), enabling safe hot‑reloads and blue/green deployments. All evaluations emit structured telemetry via an observability pipeline (e.g., OpenTelemetry), avoiding raw sensitive data while preserving end‑to‑end traceability.</p>
<hr />
<h2 id="canonical-policy-input-schema-v1">Canonical Policy Input Schema (v1)</h2>
<pre><code class="language-json">{
  &quot;agent&quot;: {
    &quot;id&quot;: &quot;string&quot;,
    &quot;type&quot;: &quot;string&quot;,
    &quot;trust_level&quot;: &quot;number&quot;,
    &quot;capabilities&quot;: [&quot;string&quot;],
    &quot;metadata&quot;: {}
  },
  &quot;tool&quot;: {
    &quot;id&quot;: &quot;string&quot;,
    &quot;name&quot;: &quot;string&quot;,
    &quot;type&quot;: &quot;string&quot;,
    &quot;operation&quot;: &quot;string&quot;,
    &quot;intended_effect&quot;: &quot;string&quot;,
    &quot;data_classification&quot;: &quot;string&quot;
  },
  &quot;context&quot;: {
    &quot;timestamp&quot;: &quot;string&quot;,
    &quot;business_hours&quot;: &quot;boolean&quot;,
    &quot;source_ip&quot;: &quot;string&quot;,
    &quot;session_age&quot;: &quot;number&quot;,
    &quot;declared_intent&quot;: &quot;string&quot;,
    &quot;inferred_intent&quot;: &quot;string&quot;,
    &quot;intent_confidence&quot;: &quot;number&quot;
  }
}
</code></pre>
<p>Validators: JSON Schema + SDK codegen (Py/TS). Clients validate before sending; the PDP re‑validates on receipt. Unknown fields are rejected to prevent silent policy bypass. Invalid or missing required fields produce a default‑deny with a clear error reason to aid debugging.</p>
<hr />
<h2 id="responsibilities">Responsibilities</h2>
<h3 id="policy-decision-point-pdp">Policy Decision Point (PDP)</h3>
<ul>
<li>
<p>Evaluate Rego policies on OPA server (not subprocess) with Redis decision cache <a href="#7">[7]</a>
  A persistent OPA instance avoids process spawn overhead and supports bundle‑based policy delivery. Redis holds recent decisions keyed by salient inputs, yielding sub‑5ms responses on hot paths.</p>
</li>
<li>
<p>Return: allow|deny|escalate, reason, conditions, audit_level
  Every decision is explicit and machine‑consumable. Conditions (e.g., "audit_level:detailed") inform downstream logging. Reasons are concise strings designed for UI/CLI display.</p>
</li>
<li>
<p>Explainability: rule trace and remediation hint (e.g., missing scope)
  The PDP exposes the rule path responsible for the outcome and provides actionable next steps, reducing friction for developers and auditors alike.</p>
</li>
<li>
<p>Hot‑reload via bundles; blue/green policy rollouts; fast rollback
  Policies ship as signed bundles. We stage and verify them before activation, enabling predictable changes and instant rollback if metrics regress.</p>
</li>
</ul>
<h3 id="policy-information-point-pip">Policy Information Point (PIP)</h3>
<ul>
<li>
<p>Assemble context from SAG: agent, tool, environment, history, and intent signals
  The PIP gathers a complete picture of the request—who is acting, what they want to do, where and when, with what history—and enriches it with intent signals (declared and inferred).</p>
</li>
<li>
<p>Normalize inputs to canonical schema; attach correlation ids
  Normalization prevents policy fragility. Correlation IDs connect decisions to audit/logs for end‑to‑end traceability across services.</p>
</li>
<li>
<p>Guard invalid/ambiguous context → escalate or deny
  If required fields are absent, or intent confidence is low for a sensitive operation, the PIP triggers escalation paths rather than guessing.</p>
</li>
</ul>
<hr />
<h2 id="decision-outcomes">Decision Outcomes</h2>
<ul>
<li>
<p>allow: proceed; include audit_level
  The gateway executes the call and the audit pipeline records the event at the prescribed level.</p>
</li>
<li>
<p>deny: include reason + remediation hint
  Denials are informative. The response explains the cause and suggests the minimal change to achieve compliance (e.g., add "read_finance" scope).</p>
</li>
<li>
<p>escalate: require human approval; attach context packet (minimal PII)
  For higher‑risk actions, the PDP signals an approval workflow. The context packet includes just enough information for a reviewer, respecting PII minimization.</p>
</li>
</ul>
<hr />
<h2 id="caching-and-performance">Caching and Performance</h2>
<ul>
<li>
<p>Redis decision cache keyed by (agent_id, tool_id, operation, intent hash, time bucket)
  Keys capture the essence of the decision while avoiding over‑specificity. Including an intent hash differentiates read vs. write paths with similar parameters.</p>
</li>
<li>
<p>TTL tuned to risk; purge on policy or context model change
  Low‑risk paths cache longer; sensitive paths expire quickly. Any policy publish or schema change invalidates affected keys.</p>
</li>
<li>
<p>Targets: P95 &lt; 5ms cached, &lt; 50ms uncached; &gt;95% cache hit for steady traffic
  These targets ensure policies do not become a bottleneck as adoption scales.</p>
</li>
</ul>
<hr />
<h2 id="interfaces">Interfaces</h2>
<ul>
<li>
<p>REST: POST /evaluate → decision, reason, conditions, audit_level, eval_ms
  The authoritative interface for services. Responses are stable and versioned; clients negotiate features via headers.</p>
</li>
<li>
<p>CLI: local evaluation for tests and CI
  Enables developers to iterate on policies quickly with reproducible inputs and golden outputs.</p>
</li>
<li>
<p>SDKs: typed client with schema validators and error taxonomy
  SDKs reduce client‑side boilerplate and ensure consistent error handling across languages.</p>
</li>
</ul>
<hr />
<h2 id="explainability-explaindeny">Explainability (Explain‑Deny)</h2>
<ul>
<li>
<p>Provide rule pathway and minimal hints: missing capability/scope, off‑hours access, data_classification violation
  Hints are intentionally narrow—enough to fix the issue without exposing sensitive policy internals. Rule pathways map to documentation for faster self‑service.</p>
</li>
<li>
<p>Developer‑friendly strings + machine fields for UI
  Human‑readable messages come with structured codes so UIs can render consistent toasts, badges, and remediation links.</p>
</li>
</ul>
<hr />
<h2 id="observability-security">Observability &amp; Security</h2>
<ul>
<li>
<p>OTel (or equivalent) traces around evaluate; structured logs (inputs hashed, not raw)
  We trace the full evaluation path, but only log hashed snapshots of inputs to prevent leakage while preserving debuggability.</p>
</li>
<li>
<p>Deny by default; rate‑limit evaluations under abuse; input size caps
  Back‑pressure protects the PDP under abnormal loads, and size caps prevent resource exhaustion.</p>
</li>
<li>
<p>Policy repo signed packages/bundles; integrity checks at load time
  Prevents tampering and ensures only verified policies are active in production.</p>
</li>
</ul>
<hr />
<h2 id="related-work-standards">Related Work &amp; Standards</h2>
<ul>
<li>OPA documentation and bundles <a href="#7">[7]</a></li>
<li>OAuth resource indicators and metadata (for token mediation alignment) <a href="#10">[10]</a>, <a href="#11">[11]</a>, <a href="#12">[12]</a></li>
<li>Intent verification, drift assurance, and formalization <a href="#17">[17]</a>, <a href="#18">[18]</a>, <a href="#19">[19]</a></li>
</ul>
<hr />
<h2 id="roadmap-alignment">Roadmap Alignment</h2>
<ul>
<li>NorthStar: OPA server + Redis, canonical input, explainability, bundles</li>
<li>Publication plan: RA‑WP2 on Sep 4; RA‑WP3 (SAG) on Sep 11; RA‑WP4 (Audit) on Sep 25</li>
<li>IGs: IG‑1 quickstart (Sep 6) shows basic decisions; IG‑3 (Oct 14) covers policy packs + explain‑deny</li>
</ul>
<hr />
<h2 id="glossary">Glossary</h2>
<ul>
<li>PDP: Policy Decision Point</li>
<li>PIP: Policy Information Point</li>
<li>Explain‑Deny: returning reason and remediation hints for denied/escalated decisions</li>
</ul>
<hr />
<h2 id="references">References</h2>
<ul>
<li>Reuse anchors from RA‑WP1 INTERNAL for [7], [10], [11], [12], [17], [18], [19].</li>
</ul>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="August 28, 2025 22:04:11 UTC">August 28, 2025</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "content.code.copy", "search.suggest", "search.highlight"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>